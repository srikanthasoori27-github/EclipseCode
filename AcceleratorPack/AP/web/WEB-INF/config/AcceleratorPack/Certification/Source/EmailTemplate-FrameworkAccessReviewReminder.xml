<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE EmailTemplate PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<!-- Copyright Â© 2018 SailPoint Technologies, Inc. All Rights Reserved.
All logos, text, content, and works of authorship, including but not limited to underlying code, programming or scripting language, designs, and/or graphics,
that are used and/or depicted herein are protected under United States and international copyright and trademark laws and treaties,
and may not be used or reproduced without the prior express written permission of SailPoint Technologies, Inc. -->
<EmailTemplate name="EmailTemplate-FrameworkAccessReviewReminder">
	<Description>
		Email Template for reminding work item owners that their work
		items are overdue.
		NOTE: In addition to the declared arguments, all entries
		from the work item attributes map are also available by name in the
		template.
	</Description>
	<Signature>
		<Inputs>
			<Argument name="certification" type="Certification">
				<Description>The Certification object.</Description>
			</Argument>
			<Argument name="nowDate" type="date">
				<Description>The current date, passed as a java.util.Date.</Description>
			</Argument>
			<Argument name="recipient" type="Identity">
				<Description>The recipient of the reminder.</Description>
			</Argument>
			<Argument name="sender" type="Identity">
				<Description>The sender of the reminder.</Description>
			</Argument>
			<Argument name="comment" type="String">
				<Description>Comment from the sender.</Description>
			</Argument>
		</Inputs>
	</Signature>
	<Subject>Urgent Action Required Access Certification Reminder</Subject>
	<Body>
		<![CDATA[
		#set($ctx = $spTools.class.forName("sailpoint.api.SailPointFactory").getMethod("getFactory", null).invoke(null,null).getCurrentContext())
		#set($ruleObj = $ctx.getObjectByName($spTools.class.forName("sailpoint.object.Rule"), "Rule-Framework-Header-Footer-StyleSheet")) 
		#set($ruleArgs = { 
		    "keyEmailTemplate"  : "styleSheet"
		}) 
		#set($styleSheet = $ctx.runRule($ruleObj, $ruleArgs))
		#if( $ruleObj )
		$ctx.decache($ruleObj)
		#end
		#set($ruleObj = $ctx.getObjectByName($spTools.class.forName("sailpoint.object.Rule"), "Rule-Framework-Header-Footer-StyleSheet")) 
		#set($ruleArgs = { 
		    "keyEmailTemplate"  : "headerTemplate"
		}) 
		#set($headerTemplate = $ctx.runRule($ruleObj, $ruleArgs))
		#if( $ruleObj )
		$ctx.decache($ruleObj)
		#end
		#set($ruleObj = $ctx.getObjectByName($spTools.class.forName("sailpoint.object.Rule"), "Rule-Framework-Header-Footer-StyleSheet")) 
		#set($ruleArgs = { 
		    "keyEmailTemplate"  : "footerTemplate"
		}) 
		#set($footerTemplate = $ctx.runRule($ruleObj, $ruleArgs))
		#if( $ruleObj )
		$ctx.decache($ruleObj)
		#end
	    #set($currentYear = $spTools.formatDate($certification.getActivated(),"YYYY"))
	    #set($dueDate = $spTools.formatDate($certification.getExpiration(),"MMMM dd, YYYY"))
	    <html>
	    <head>
		<meta charset="UTF-8">	    
		#if( $styleSheet )
		$styleSheet
		#end 
		</head>
	    	<body>
	    	#if( $headerTemplate )
			$headerTemplate
			#end
			<br/>    	
			#if ($recipient.getDisplayName()) 
				Dear $recipient.getDisplayName(),<br/>
			#elseif($recipient.getFirstname())
				Dear $recipient.getFirstname(),<br/>
			#else
				Dear $recipient.getName(),<br/>
			#end<br/> 	
   		    <p>
			The $currentYear Mover Access Review was scheduled to be completed on $dueDate
			</p>
			<p>
            $certification.getCertificationName() - #set($c=$certification.getExpiration().getTime()) #set($t = $nowDate.getTime())  #set($d = $c - $t) #set($dd = ($d/(24*60*60*1000))+1) $dd days remaining for completion
            </p>
			#if( $footerTemplate )
			$footerTemplate
			#end
			</body>
		</html>
		]]>
	</Body>
</EmailTemplate>
