<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE Rule PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<!-- Copyright © 2018 SailPoint Technologies, Inc. All Rights Reserved.
All logos, text, content, and works of authorship, including but not limited to underlying code, programming or scripting language, designs, and/or graphics,
that are used and/or depicted herein are protected under United States and international copyright and trademark laws and treaties,
and may not be used or reproduced without the prior express written permission of SailPoint Technologies, Inc. -->
<Rule language="beanshell" name="Rule-FrameworkEmailRecipientCcFirstManager"
	type="EmailRecipient">
	<Description>Adds the item owner's immediate manager as an additional email recipient.</Description>
	<Signature returnType="String or List of Strings">
		<Inputs>
			<Argument name="log">
				<Description>
					The log object associated with the SailPointContext.
				</Description>
			</Argument>
			<Argument name="context">
				<Description>
					A sailpoint.api.SailPointContext object that can be used to query
					the database if necessary.
				</Description>
			</Argument>
			<Argument name="item">
				<Description>
					The sailpoint.object.Notifiable Interface for objects that can be
					reminded, escalated, and expired.
				</Description>
			</Argument>
		</Inputs>
		<Returns>
			<Argument name="identity name or names">
				<Description>
					You can return an identity name or a list of identity names.
				</Description>
			</Argument>
		</Returns>
	</Signature>
	<Source>
		<![CDATA[
		import sailpoint.object.Identity;
		import sailpoint.object.Custom;
		//Default owner is the No Manager Found workgroup
		String defaultRecipient = "No Manager Found";
		Identity newRecipient = null;
		//Obtain the owner of the item
		Identity owner = item.getOwner();
		//If no owner, add default owner as recipient
		if (owner == null) {
			return defaultRecipient;
		}
		else {
			//Add owner’s manager as additional recipient
			newRecipient = owner.getManager();
			//If manager is null
			if(newRecipient == null) {
				return defaultRecipient;
			}
		}
		return newRecipient.getName();
		]]>
	</Source>
</Rule>
