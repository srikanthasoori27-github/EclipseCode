<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE Form PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<!-- Copyright Â© 2018 SailPoint Technologies, Inc. All Rights Reserved.
All logos, text, content, and works of authorship, including but not limited to underlying code, programming or scripting language, designs, and/or graphics,
that are used and/or depicted herein are protected under United States and international copyright and trademark laws and treaties,
and may not be used or reproduced without the prior express written permission of SailPoint Technologies, Inc. -->
<Form name="Form-Ticket-Status" type="Workflow">
  <Attributes>
    <Map>
      <entry key="title" value="Check Ticket Status"/>
    </Map>
  </Attributes>
  <Description>Ticket Status</Description>
  <Section name="roadTicketIntegration">
   <Attributes>
   <Map>
    <entry key="subtitle">
	<value>
	 <Script>
	  <Source><![CDATA[
	  	 String subtitle="Check Ticket Status For Integration ";
	  	 if(autoSelectIntegrationConfig!=void && autoSelectIntegrationConfig!=null)
	  	 {
		 subtitle = subtitle +autoSelectIntegrationConfig;
		 }
		 else if(roadIntegrationConfigSelect!=void && roadIntegrationConfigSelect!=null)
		 {
		 subtitle = subtitle +roadIntegrationConfigSelect;
		 }
		 return subtitle;
	]]></Source>
     </Script>
	</value>
	</entry>
   </Map>
    </Attributes>
    <Field displayName="Ticket Id" name="ticketId" type="string" required="true" helpKey="Please Enter Ticket Id and Click Check Ticket Status Button">
    </Field>
  </Section>
  <Section label="Ticket Status and Connection" name="roadTicketStatus" columns="2" type="datatable">
    <Field displayName="Provided Ticket Id" name="ticketIdSelected" type="string" dynamic="true">
     <Script>
        <Source><![CDATA[
	           return ticketId;
	     	]]></Source>
      </Script>
    </Field>
     <Field displayName="IdentityIQ Ticket Status Code" name="ticketStatus" type="string" dynamic="true" >
       <Script>
        <Source><![CDATA[
        		import sailpoint.rapidapponboarding.rule.CheckTicketStatusExecutor;
	           if(ticketId!=null)
	           {
	              String configName=null;
		          if(autoSelectIntegrationConfig!=void && autoSelectIntegrationConfig!=null)
		  	 	  {
		          configName=autoSelectIntegrationConfig;
		          }
		          else if(roadIntegrationConfigSelect!=void && roadIntegrationConfigSelect!=null)
		  	 	  {
		          configName=roadIntegrationConfigSelect;
		          }
		          if(configName!=null)
		          {
		             return CheckTicketStatusExecutor.getStatusFromTicketIntegration(context,ticketId,configName);
				  }
		       }
			]]></Source>
      </Script>
    </Field>
      </Section>
     <Section label="IdentityIQ Ticket Status Code Translation" name="roadTicketStatusInformation" columns="3" type="datatable">
    <Field displayName="committed" value="Ticket is Fulfilled" name="committed" type="string"  >
    </Field>
     <Field displayName="failure" value="Ticket Id is Invalid or Ticket Not Fulfilled" name="failure" type="string"  >
    </Field>
     <Field displayName="inProcess" value="Ticket is Pending" name="inProcess" type="string">
    </Field>
  </Section>
  <Button action="cancel" label="Cancel"/>
  <Button action="refresh" label="Check Ticket Status"/>
 </Form>
