<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE Rule PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<Rule language="beanshell" name="AEV-RuleLibray-ProvPolicyGSuite">
  <Source>
    
import java.util.*;  
import java.lang.*;  
import sailpoint.object.QueryOptions;
import sailpoint.object.Filter;
import sailpoint.object.Identity;
import java.util.Iterator;
import java.util.ArrayList;
	
  public static String ouMapping(String idCompanyName, String idCompanyCode, String idDepartmentName, String idUnit, String idLocationName, String idSource){
	
 String csvFile = "/home/infocentric/CSV/AEV_GSuite_OUMapping.csv";

        BufferedReader br = null;
        String line = "";
        String cvsSplitBy = "||";
	String companyName = "";
		String companyCode = "";
		String department = "";
		String unit = "";
		String location = "";
		String ou = "";


        try {

            br = new BufferedReader(new FileReader(csvFile));
            while ((line = br.readLine()) != null) {

                // use comma as separator
				
                String[] csv = line.split(",(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)");
              
		    companyName = csv[0];
				companyCode = csv[1];
				department = csv[2].replace("\"", "");
				unit = csv[3].replace("\"", "");
        location = csv[4];
				ou = csv[5];

			if (idSource.equalsIgnoreCase("Ramco") || idSource.equalsIgnoreCase("Ramco CSV")) {
					if (idLocationName.equalsIgnoreCase("")) { 
						if (idCompanyName.equalsIgnoreCase(companyName)) {
						return ou;
						} 
				    } else if (idLocationName != null){			
						if (idCompanyName.equalsIgnoreCase(companyName) &amp;&amp; idLocationName.equalsIgnoreCase(location)) {
						return ou;
						} 
					}
				} else if (idSource.equalsIgnoreCase("SAP SF CSV") || idSource.equalsIgnoreCase("SuccessFactors")) {
					if (idLocationName.equalsIgnoreCase("")) { 
						if (idCompanyCode.equalsIgnoreCase(companyCode) &amp;&amp; idDepartmentName.equalsIgnoreCase(department) &amp;&amp; idUnit.equalsIgnoreCase(unit) ) {
						return ou;
						} 
					} else if (idLocationName != null) { 
						if (idCompanyCode.equalsIgnoreCase(companyCode) &amp;&amp; idDepartmentName.equalsIgnoreCase(department) &amp;&amp; idUnit.equalsIgnoreCase(unit) &amp;&amp; idLocationName.equalsIgnoreCase(location)) {
						return ou;
						} 
					}
						
				} 	
            }

			return "/AEV - Donot Add Users Here -";
	
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            if (br != null) {
                try {
                    br.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
		}
  
	
</Source>
</Rule>