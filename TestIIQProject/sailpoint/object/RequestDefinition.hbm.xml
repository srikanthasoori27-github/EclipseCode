<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
  "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd" [
  <!ENTITY SailPointObject SYSTEM "classpath://sailpoint/object/SailPointObject.hbm.xml">
  <!ENTITY TaskItemDefinition SYSTEM "classpath://sailpoint/object/TaskItemDefinition.hbm.xml">
]>

<!-- (c) Copyright 2008 SailPoint Technologies, Inc., All Rights Reserved. -->

<hibernate-mapping>
  <class name="sailpoint.object.RequestDefinition">

    &TaskItemDefinition;

    <many-to-one embed-xml="false" name="parent" class="sailpoint.object.RequestDefinition"/>

    <property name="retryMax" type="int"/>
    <property name="retryInterval" type="int"/>

    <list name="rights" table="RequestDefinitionRights"
          cascade="persist,merge,save-update">
      <key column="request_definition_id"/>
      <list-index column="idx"/>
      <many-to-many column="right_id" class="sailpoint.object.SPRight"/>
    </list>

    <!-- Note that Signature is also used by Rule and TaskDefinition, so if
         you change the definition here, you probably also need to change
         Rule.hbm.xml and TaskDefinition.hbm.xml.  Also note that the table
         names for the arguments and returns have to be different than those
         used by Rule, or else there will be conflicting foreign key
         constraints.
     -->
    <component name="signature" class="sailpoint.object.Signature">

      <property name="description" type="materialized_clob" column="sigDescription" length="8192"/>
      <property name="returnType"/>

      <list name="arguments" table="RequestArguments">
        <key column="signature"/>
        <list-index column="idx"/>
        <composite-element class="sailpoint.object.Argument">
          <property name="name"/>
          <property name="type"/>
          <property name="filterString"/>
          <property name="description" type="materialized_clob" length="8192"/>
          <property name="prompt" type="materialized_clob" length="8192"/>
          <property name="multi" type="boolean"/>
          <property name="required" type="boolean"/>
        </composite-element>
      </list>

      <list name="returns" table="RequestReturns">
        <key column="signature"/>
        <list-index column="idx"/>
        <composite-element class="sailpoint.object.Argument">
          <property name="name"/>
          <property name="type"/>
          <property name="filterString"/>
          <property name="description" type="materialized_clob" length="8192"/>
          <property name="prompt" type="materialized_clob" length="8192"/>
          <property name="multi" type="boolean"/>
        </composite-element>
      </list>

    </component>

  </class>
</hibernate-mapping>
