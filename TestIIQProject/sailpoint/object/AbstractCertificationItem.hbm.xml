<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
  "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd" [
  <!ENTITY SailPointObject SYSTEM "classpath://sailpoint/object/SailPointObject.hbm.xml">
]>

<!-- (c) Copyright 2008 SailPoint Technologies, Inc., All Rights Reserved. -->

<hibernate-mapping>
  <class name="sailpoint.object.AbstractCertificationItem" abstract="true">

    &SailPointObject;

    <!-- Explicitly setting lazy to false seems to be necessary to avoid
         XML serialization problems. Apparently the XML serializer can't
         deal with "enhanced" classes?
     -->
    <many-to-one embed-xml="false" name="action" class="sailpoint.object.CertificationAction" 
                 cascade="all" lazy="false"/>

    <many-to-one embed-xml="false" name="delegation"
                 class="sailpoint.object.CertificationDelegation" 
                 cascade="all" lazy="false"/>

    <property name="completed" type="sailpoint.persistence.DateType"/>

    <!-- Note: Index is named "_status" because hibernate will append this
         to the table name when generating the index since this is the parent
         of a union-subclass.
     -->
    <property name="summaryStatus" index="_stat">
      <type name="sailpoint.persistence.EnumType">
        <param name="enumClassName">sailpoint.object.AbstractCertificationItem$Status</param>
      </type>
    </property>

    <property name="continuousState" index="_state">
      <type name="sailpoint.persistence.EnumType">
        <param name="enumClassName">sailpoint.object.AbstractCertificationItem$ContinuousState</param>
      </type>
    </property>
    
    <!--
      Oracle has a max index name length of 30 characters, and hibernate will
      prepend the "spt_certification_item/entity" prefix to the index name, so
      we've got to go with some very short abbreviations for these indexes.
     -->
    <property name="lastDecision" type="sailpoint.persistence.DateType" index="_ld" />
    <property name="nextContinuousStateChange" type="sailpoint.persistence.DateType" index="_nsc" />
    <property name="overdueDate" type="sailpoint.persistence.DateType" index="_due" />

    <property name="hasDifferences" type="boolean" index="_diffs" />
    <property name="actionRequired" type="boolean"/>

    <property name="targetDisplayName"/>
    <property name="targetName" index="_tn"/>
    <property name="targetId"/>

    <!--
      jsl - do we still need these now that we have extended attributes?
    -->
    <property name="hibernateCustom1" column="custom1" type="string" length="450"/>
    <property name="hibernateCustom2" column="custom2" type="string" length="450"/>
    <property name="hibernateCustomMap" column="custom_map" type="sailpoint.persistence.XmlType" length="100000000"/>

  </class>
</hibernate-mapping>
