<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
  "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd" [
  <!ENTITY SailPointObjectChild SYSTEM "classpath://sailpoint/object/SailPointObjectChild.hbm.xml">
  <!ENTITY IndexBase "reqitem">
  <!ENTITY PersistentIdentityItem SYSTEM "classpath://sailpoint/object/PersistentIdentityItem.hbm.xml">
]>

<!-- (c) Copyright 2008 SailPoint Technologies, Inc., All Rights Reserved. -->

<hibernate-mapping>
  <class name="sailpoint.object.IdentityRequestItem"
    dynamic-update="true" dynamic-insert="true">  

    &SailPointObjectChild;
    &PersistentIdentityItem;

    <property name="application" type="string"/>
    
    <property name="ownerName" type="string" length="128" 
              index="spt_reqitem_ownername"/> 
    <property name="approverName" type="string" length="128" 
              index="spt_reqitem_approvername"/>
    <property name="operation" length="128"/>
    <property name="retries" type="int"/>
    <property name="provisioningEngine"/>

    <property name="approvalState" index="spt_reqitem_approval_state" length="128">
      <type name="sailpoint.persistence.EnumType">
        <param name="enumClassName">sailpoint.object.WorkItem$State</param>
      </type>
    </property>

    <property name="provisioningState" index="spt_reqitem_provisioning_state" length="128">
      <type name="sailpoint.persistence.EnumType">
        <param name="enumClassName">sailpoint.object.ApprovalItem$ProvisioningState</param>
      </type>
    </property>

    <property name="compilationStatus" index="spt_reqitem_comp_status" length="128">
      <type name="sailpoint.persistence.EnumType">
        <param name="enumClassName">sailpoint.object.IdentityRequestItem$CompilationStatus</param>
      </type>
    </property>

    <property name="expansionCause" index="spt_reqitem_exp_cause" length="128">
      <type name="sailpoint.persistence.EnumType">
        <param name="enumClassName">sailpoint.object.ExpansionItem$Cause</param>
      </type>
    </property>

    <!--  inverse relationship -->
    <many-to-one embed-xml="false" name="identityRequest" column="identityRequestId" class="sailpoint.object.IdentityRequest"/>

    <list name="attachments" table="spt_identity_req_item_attach"
          cascade="delete" lazy="extra">
      <key column="identityRequestItem_id"/>
      <list-index column="idx"/>
      <many-to-many column="attachment_id" class="sailpoint.object.Attachment"/>
    </list>
    
  </class>
</hibernate-mapping>
